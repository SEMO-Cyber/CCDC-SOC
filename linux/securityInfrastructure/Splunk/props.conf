[linpeas]
# Merge lines
SHOULD_LINEMERGE = true
# Never break on regex (swallow the whole file)
BREAK_ONLY_BEFORE = ^\s*this_string_will_never_occur\s*$
# Use current time
DATETIME_CONFIG = CURRENT
# Allow unlimited BYTE size
TRUNCATE = 0
# Allow up to 10,000 lines per event (Default is 256)
MAX_EVENTS = 10000

[linux_enum]
# Merge lines
SHOULD_LINEMERGE = true
# Never break on regex (swallow the whole file)
BREAK_ONLY_BEFORE = ^\s*this_string_will_never_occur\s*$
# Use current time
DATETIME_CONFIG = CURRENT
# Allow unlimited BYTE size
TRUNCATE = 0
# Allow up to 10,000 lines per event (Default is 256)
MAX_EVENTS = 10000

# =============================================================================
# IPTables Log Extraction from kern.log and messages
# Separates iptables events into dedicated sourcetype for easier searching
# =============================================================================

[source::.../var/log/kern.log]
TRANSFORMS-iptables = extract_iptables_to_sourcetype

[source::.../var/log/messages]
TRANSFORMS-iptables = extract_iptables_to_sourcetype

# Define the new sourcetype for iptables
[iptables]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = ^
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 32

# Field extractions for iptables logs
EXTRACT-iptables_fields = (?:IPT|FW)-(?<ipt_chain>[^:\s]+):?\s+.*IN=(?<ipt_in_interface>\S*)\s+OUT=(?<ipt_out_interface>\S*)\s+.*SRC=(?<src_ip>[0-9.]+)\s+DST=(?<dest_ip>[0-9.]+).*PROTO=(?<protocol>\w+).*SPT=(?<src_port>\d+)\s+DPT=(?<dest_port>\d+)

# =============================================================================
# Wazuh Alerts JSON formatting
# =============================================================================

[wazuh:alerts]
SHOULD_LINEMERGE = false
TRUNCATE = 0
TIME_PREFIX = "timestamp":"
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N%z
MAX_TIMESTAMP_LOOKAHEAD = 28
KV_MODE = json

# =============================================================================
# Technitium DNS Syslog
# =============================================================================

[technitium:syslog]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = ^
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 32

# =============================================================================
# Cowrie SSH Honeypot (JSON)
# =============================================================================

[cowrie]
SHOULD_LINEMERGE = false
TRUNCATE = 0
TIME_PREFIX = "timestamp":"
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N%z
MAX_TIMESTAMP_LOOKAHEAD = 32
KV_MODE = json

# =============================================================================
# Suricata IDS
# =============================================================================

[suricata:eve]
SHOULD_LINEMERGE = false
TRUNCATE = 0
TIME_PREFIX = "timestamp":"
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N%z
MAX_TIMESTAMP_LOOKAHEAD = 32
KV_MODE = json

[suricata:fast]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = ^
TIME_FORMAT = %m/%d/%Y-%H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 24

# =============================================================================
# Zeek Network Security Monitor (JSON format)
# =============================================================================
# Zeek is configured with: redef LogAscii::use_json = T;
# JSON logs provide automatic field extraction via KV_MODE = json
# Timestamp is in "ts" field as Unix epoch with microseconds
# =============================================================================

[zeek:conn]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:dns]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:http]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json
# Rename Zeek's "host" field (HTTP Host header) to prevent it from
# overriding Splunk's built-in host metadata (the log source device).
# The domain is still available as "domain_host" in searches.
SEDCMD-rename_zeek_host = s/"host":/"domain_host":/g

[zeek:notice]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:ssl]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:ssh]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:dce_rpc]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:smb_mapping]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:smb_files]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:kerberos]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:files]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

[zeek:x509]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "ts":
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = json

# =============================================================================
# Falco Runtime Security
# =============================================================================

[falco:alerts]
SHOULD_LINEMERGE = false
TRUNCATE = 10000
TIME_PREFIX = "output_fields.evt.time":
TIME_FORMAT = %s
KV_MODE = json
